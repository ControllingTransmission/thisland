<!DOCTYPE html>
<html lang="en">
	<head>
		<title>dots</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				background-color: #000;
				margin: 0px;
				overflow: hidden;
			}
		</style>
	</head>
	<body>

		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.hotkeys.js"></script>

		<script src="js/three.min.js"></script>
		<script src="js/loaders/DDSLoader.js"></script>
		<script src="js/loaders/MTLLoader.js"></script>
		<script src="js/loaders/OBJLoader.js"></script>

    <script src="AudioContextMonkeyPatch.js"></script>
		<script src="Spectrum.js"></script>

		<script src="controllers/Trees.js"></script>
		<script src="controllers/Planet.js"></script>
		<script src="controllers/RunnerGround.js"></script>
		<script src="controllers/BandName.js"></script>
		<script src="controllers/Gameboy.js"></script>
		<script src="controllers/Skybox.js"></script>

		<script src="hotkeys.js"></script>
		

		<script>
		
			// COLORSETS = {}
			// COLORSETS.RAINBOWBRITE = new Array('#71c8bf', '#1ba554', '#cad93b', '#fef02f', '#fbb62c', '#f38a2e', '#ee592c', '#ea1d2b', '#b42767', '#65328f', '#52529f', '#20aeda');

			COLORSETS = [
/*				[
					'#0084cc',
					'#0596ff',
					'#ffbc42',
					'#ff146a',
					'#b5386c'
				],*/
				[
					'#006ba6',
					'#0496ff',
					'#ffbc42',
					'#d81159',
					'#8f2d56',
				],
				[
					'#f9c80e',
					'#f86624',
					'#ea3546',
					'#662e9b',
					'#43bccd',
				],
				[
					'#3c1642',
					'#086375',
					'#1dd3b0',
					'#affc41',
					'#b2ff9e',
				],
				[
					'#540d6e',
					'#ee4266',
					'#ffd23f',
					'#3bceac',
					'#0ead69',
				],
				[
					'#e6c229',
					'#f17105',
					'#d11149',
					'#6610f2',
					'#1a8fe3',
				],
				[
					'#04e762',
					'#f5b700',
					'#00a1e4',
					'#dc0073',
					'#89fc00',
				],
				[
					'#3d348b',
					'#7678ed',
					'#f7b801',
					'#f18701',
					'#f35b04',
				],
			]


			//PI = 3.14159265359

			
			var container;

			var camera, scene, renderer, tree, skin, planets;
			planets = []
			
			$(document).ready(function()
			{
				init();
				animate();
			})
			
			function init() 
			{
				
				container = document.createElement( 'div' );
				document.body.appendChild( container );

				camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 4000000 );
				camera.position.z = 2500;
				camera.position.y = 300

				cameraCube = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 1, 100000 );
				cameraCube.rotation.speed = {x:0, y:0.005, z:0.005}

				scene = new THREE.Scene();
				sceneCube = new THREE.Scene();
				scene.addObject = function(object){
					this.add(object)
				}

				light = null;
				var object;

				ambientLight = new THREE.AmbientLight( 0x404040 );
				ambientLight.position.set( 0, 1000, 5000 )
				scene.add( ambientLight );

				spotLight = new THREE.SpotLight( 0xffffff );
				spotLight.position.set( 0, 4000, -5000 );

				spotLight.castShadow = true;

				spotLight.shadowMapWidth = 1024;
				spotLight.shadowMapHeight = 1024;

				spotLight.shadowCameraNear = 500;
				spotLight.shadowCameraFar = 4000;
				spotLight.shadowCameraFov = 40;

				scene.add( spotLight );

				var light = new THREE.HemisphereLight( 0xcccccc, 0x080820, 1 );
				light.position.set( 0, 500, 3000 );
				scene.add( light );

				// light = new THREE.DirectionalLight( 0xffffff );
				// light.position.set( 200, 2000, 3500 );
				// light.rotation.set( 45, 0, 0);
				// scene.add( light );


				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.autoClear = false;

				container.appendChild( renderer.domElement );
				window.addEventListener( 'resize', onWindowResize, false );
				setupBindings()

				initSkybox();

				runnerGround = new RunnerGround().init();

				bandname = new BandName(function(){console.log('loaded');}).init();
				bandname.position.set(0, 1000, -2000)
				bandname.scale.set(100, 100, 100)
				scene.add(bandname)

				gameboy = new Gameboy().init();

				// planet = new Planet().init();

			}

			function radians(angle){
				//Angle supplied in degrees, needs to be converted to radians
				return angle * (Math.PI / 180);
			}


			function addObject()
			{
				object = createShape(2);
				return object
			}
			
			function onWindowResize() 
			{
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}

			function animate() 
			{
				requestAnimationFrame( animate );
				render();
			}

			function render() 
			{
				bins = Spectrum.timeStep()
				//console.log("bins: " + JSON.stringify(bins))
				var timer = Date.now() *.009 

				runnerGround.update(bins)
				// bandname.update()
				gameboy.update()

				cameraCube.rotation.x += cameraCube.rotation.speed.x
				cameraCube.rotation.y += cameraCube.rotation.speed.y
				cameraCube.rotation.z += cameraCube.rotation.speed.z
				// prepareBlur()

				renderer.render( sceneCube, cameraCube );
				renderer.render( scene, camera );
				
			}

			function setupBindings()
			{
				
			}

			
		</script>
	</body>
</html>
